<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="users">
    
    
	<select id="isJoinedCheckById" parameterType="map" resultType="String">
	    select Count(num) 
   		from user
   		where id= #{id} 
	</select>
    
	<select id="isMasterById" parameterType="map" resultType="map">
	select isMaster, beautyNum
	from user
	where id= #{id} 
	</select>
		
	<update id="loginTimeUpdate" parameterType="map">  
	    update user set contact_date = #{contact_date} 
	    where id = #{id}
	</update>
	
	<insert id="insertUser" parameterType="map">  
	    insert into user (num,phone_id,beautyNum,id,name,sex,isMaster,joindate,contact_date,penalty_count,penalty_create_date,temp) 
  		values (NULL,#{phone_id},0,#{id},#{name},#{sex},#{isMaster},#{joindate},#{contact_date},0,#{contact_date},#{temp})
	</insert>
	<insert id="updateUser" parameterType="map">  
	    update user 
	    set phone_id=#{phone_id}, sex=#{sex}, name=#{name} 
	    where id=#{id}
	</insert>
	
	
	<select id="getBeautyInfo" parameterType="map" resultType="map">
	    select num, title, working_time_from, working_time_to, loc, booking_method, booking_delay_time,booking_delay_time_for_cut, phone, isNotice, notice, master_id, dayOff 
   		from beauty 
   		where num= #{beautyNum} 
	</select>
	
	<select id="check_penalty_count" parameterType="map" resultType="map">
	    select penalty_count 
	    from user 
	    where id = #{id} 

	</select>
	
	<select id="loginById_getBeautyInfo" parameterType="map" resultType="map">
	    select U.isMaster,U.penalty_count, B.num, B.title, B.working_time_from, B.working_time_to, B.loc, B.booking_method, B.booking_delay_time, B.booking_delay_time_for_cut, B.phone, B.dayOff,B.master_id, B.isNotice, B.notice 
   		from beauty B 
       	inner JOIN user U on U.beautyNum = B.num 
   		where U.id = #{id} 
	</select>
	
	<update id="master_make_penalty" parameterType="map">  
	    update user set penalty_count = penalty_count+1, penalty_create_date=#{penalty_create_date} 
	    where id = #{user_id}
	</update>
	
	
	
	
	
	<select id="userList" resultType="map">
		select * from user
	</select>

	<select id="userInfoByEmail" parameterType="map" resultType="map">
		select USERNO, USERID, PASSWORD from NETTY_EXAMPLE_DB.USERS where USERID = #{email}
	</select>

	<select id="userInfoByPassword" parameterType="map" resultType="map">
		select USERID, USERID, PASSWORD from NETTY_EXAMPLE_DB.USERS where userNo = #{userNo} and password = #{password}
	</select>
</mapper>
<!-- 
USERNO INT GENERATED BY DEFAULT AS IDENTITY 
          (START WITH 1, INCREMENT BY 1) NOT NULL,
    USERID VARCHAR(45) NOT NULL,
	USERNAME VARCHAR(45) NOT NULL,
	PASSWORD VARCHAR(45) NOT NULL,
 -->